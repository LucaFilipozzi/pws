# pws

A reimplementation of Peter Palfrader's [pwstore][1]
- implemented in ruby, leveraging [ruby-gpgme][3] and [thor][4]
- command line interface differs: 'new' for 'ed -n', 'mod' for 'ed', 'enc' for 'rc'
- 100% compatible with `~/.pws.yaml` but not `~/.pws-trusted-users`
- 90% compatible with `dir/.users` in that entries must be defined before being used
- currently ignores `dir/.keyring` however

Ultimately, the purpose of both [pwstore][1] and this reimplementation is
two-fold:
- to ensure that the encryption recipients are correct and complete by
  validating access lines (first line of a file) against the users and groups
  defined in `dir/.users`
- to prevent plaintext copies from being generated by leveraging ruby's
  [Tempfile][2] class which automatically deletes the temporary file when the
  object goes out of scope, and by invoking the editor -- via `system()` -- to
  edit the temporary file

Four opportunities remain:
- determine whether [ruby-gpgme][3] permits the use of an alternate public keyring: this
  would allow this reimplementation to make use of `dir/.keyring`
- determine whether [ruby-gpgme][3] could emit the encryption recipients of an encrypted
  file without explicitly decrypting it (by examining the underlying packets): this would
  allow the 'dir' command to be implemented so that encrypted files may be verified as
  having been encrypted for the appropriate recipients while avoiding the overhead
  of decryption or the irritation of prompting for the private key passphrase
- determine whether [ruby-gpgme][3] can import public keys from keyservers: this would
  allow us to avoid retrieving public keys from https://sks-keyservers.net/pks/lookup
- transition `dir/.users` from custom-format to YAML

[1]: https://github.com/weaselp/pwstore
[2]: http://ruby-doc.org/stdlib-2.2.3/libdoc/tempfile/rdoc/Tempfile.html
[3]: https://github.com/ueno/ruby-gpgme
[4]: https://github.com/erikhuda/thor
